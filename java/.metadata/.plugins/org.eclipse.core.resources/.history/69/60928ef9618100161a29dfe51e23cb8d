import java.awt.BorderLayout;
import java.io.File;
import java.util.ArrayList;
import java.util.List;
import java.util.concurrent.Callable;
import java.util.concurrent.CompletionService;
import java.util.concurrent.ExecutionException;
import java.util.concurrent.ExecutorCompletionService;
import java.util.concurrent.ExecutorService;
import java.util.concurrent.Executors;
import java.util.concurrent.Future;

import javax.swing.JButton;
import javax.swing.JFrame;
import javax.swing.JPanel;
import javax.swing.JScrollPane;
import javax.swing.JTable;

import Main.AddAction;
import Main.RemoveAction;

public class Main{
	private static Table t = new Table();
    private JTable tableau;
	
	public static void main(String[] args) throws InterruptedException, ExecutionException {
		// TODO Auto-generated method stub
		JFrame fenetre = new JFrame();
		fenetre.setVisible(true);
		fenetre.setTitle("Application File");
		fenetre.setSize(800, 400);
		fenetre.setLocation(100, 100);
		fenetre.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
		
		ExecutorService execute = Executors.newFixedThreadPool(4);
		File[] racines = File.listRoots();
		List<File> res = null;
		List<Future<List<File>>> futures = new ArrayList<Future<List<File>>>();
		CompletionService<List<File>> completionService = new ExecutorCompletionService<List<File>>(execute);
		for (File racine : racines)
		{
			futures.add(completionService.submit(new NewCallable(racine.getAbsolutePath())));
		}
		execute.shutdown();
		
		for(int i = 0; i < racines.length; i++)
		{
			res = completionService.take().get();
			if(res != null)
			{
				for(File re : res)
				{
					t.addFile(new Fichier(re.getAbsolutePath(),re.getName(),re.lastModified(),re.length()));
					//System.out.println(re.getAbsolutePath());
				}
			}
		}
		tableau = new JTable(t);
		 
        fenetre.getContentPane().add(new JScrollPane(tableau), BorderLayout.CENTER);
 
        JPanel boutons = new JPanel();
 
        boutons.add(new JButton(new AddAction()));
        boutons.add(new JButton(new RemoveAction()));
 
        fenetre.getContentPane().add(boutons, BorderLayout.SOUTH);
 
        fenetre.pack();
	}
}
